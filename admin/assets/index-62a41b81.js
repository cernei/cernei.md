import{r as u,o as r,c,a as d,F as y,b as ue,d as ee,e as F,f as i,t as w,n as L,g as T,u as R,h as b,i as j,s as de,w as C,j as O,k as te,l as oe,m as W,p as me,q as pe,v as _e,x as fe,y as ge,z as Q,A as be,B as he,C as ye,D as ve,E as xe,G as $e,H as we,I as Ce,J as ke,K as Te,L as Se,P as Pe,T as Be,M as Oe}from"./vendor-2df05f0c.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))m(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const l of s.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&m(l)}).observe(document,{childList:!0,subtree:!0});function o(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function m(n){if(n.ep)return;n.ep=!0;const s=o(n);fetch(n.href,s)}})();const A=(e,t)=>{const o=e.__vccOpts||e;for(const[m,n]of t)o[m]=n;return o},je={};function Ve(e,t){const o=u("Toast"),m=u("router-view");return r(),c(y,null,[d(o),d(m)],64)}const Ie=A(je,[["render",Ve]]);const Ue="http://demo-laravel-backend.cernei.md",B=ue.create({baseURL:Ue,withCredentials:!0}),Fe=[["email"],["password"]],De={email:{component:"text",label:"Email",validation:{required:!0,pattern:"email",max:128}},password:{component:"text",label:"Password",validation:{required:!0,max:64,min:6}}},Ee={email:"admin@gmail.com",password:"12345678"},qe={class:"p-component"},Le={class:"flex gap-3"},Re={class:"flex-1 mb-3"},Ae=["for"],ze={class:"p-error ml-1"},Me={class:"p-error ml-1"},He={class:"p-error ml-1"},Ke={class:"flex flex-column gap-3 ml-3"},We=["for"],Ge={class:"p-error ml-1"},z={__name:"FormBuilderGrid",props:["form","layout"],setup(e){const t=e;function o(s){return t.form.submitted||t.form.errors[s]?t.form.errors[s]:""}const m=Object.keys(t.form.config),n=ee({});return m.forEach(s=>{const l=t.form.config[s];l.dictionary?B.post("api/dictionaries/"+l.dictionary).then(_=>{n[s]=_.data.data}):l.options&&(n[s]=l.options)}),(s,l)=>{const _=u("InputText"),p=u("Textarea"),f=u("Dropdown"),S=u("Checkbox");return r(),c("div",qe,[(r(!0),c(y,null,F(e.layout,h=>(r(),c("div",Le,[(r(!0),c(y,null,F(h,a=>(r(),c("div",Re,[i("label",{for:a,class:"block text-900 font-medium mb-2"},w(e.form.config[a].label),9,Ae),e.form.config[a].component==="text"?(r(),c(y,{key:0},[d(_,{id:a,type:"text",class:L(["w-full",{"p-invalid":e.form.errors[a]}]),modelValue:e.form.state[a],"onUpdate:modelValue":v=>e.form.state[a]=v,disabled:e.form.config[a].disabled,onInput:v=>e.form.validate(a)},null,8,["id","class","modelValue","onUpdate:modelValue","disabled","onInput"]),i("small",ze,w(o(a)),1)],64)):T("",!0),e.form.config[a].component==="textarea"?(r(),c(y,{key:1},[d(p,{class:L(["w-full",{"p-invalid":e.form.errors[a]}]),modelValue:e.form.state[a],"onUpdate:modelValue":v=>e.form.state[a]=v,onInput:v=>e.form.validate(a),rows:"5",cols:"30"},null,8,["class","modelValue","onUpdate:modelValue","onInput"]),i("small",Me,w(o(a)),1)],64)):T("",!0),e.form.config[a].component==="select"?(r(),c(y,{key:2},[d(f,{modelValue:e.form.state[a],"onUpdate:modelValue":v=>e.form.state[a]=v,class:L([{"p-invalid":e.form.errors[a]},"w-full"]),onChange:v=>e.form.validate(a),options:n[a],optionLabel:"name",placeholder:"Select a value",optionValue:"id"},null,8,["modelValue","onUpdate:modelValue","class","onChange","options"]),i("small",He,w(o(a)),1)],64)):T("",!0),e.form.config[a].component==="checkbox-group"?(r(),c(y,{key:3},[i("div",Ke,[(r(!0),c(y,null,F(n[a],v=>(r(),c("div",{key:v.id,class:"flex align-items-center gap-1"},[d(S,{modelValue:e.form.state[a],"onUpdate:modelValue":M=>e.form.state[a]=M,inputId:v.id,name:a,value:v.id},null,8,["modelValue","onUpdate:modelValue","inputId","name","value"]),i("label",{for:v.id,class:"text-800 text-sm"},w(v.name),9,We)]))),128))]),i("small",Ge,w(o(a)),1)],64)):T("",!0)]))),256))]))),256))])}}};function G(e,t){const o={};Object.keys(e).forEach(p=>{o[p]=""});const m={...o},n=ee({state:{...t},config:e,errors:m,validate:_,submit:l,submitted:!1}),s={required:p=>{const f="Required";return Array.isArray(p)?p.length?"":f:p?"":f},max:(p,f)=>p&&p.length>f?"Should be no longer than "+f:"",min:(p,f)=>p&&p.length<f?"Should be longer than "+f:"",pattern:(p,f)=>{if(f==="email")return p.match(/^[^\s@]+@[^\s@]+\.[^\s@]+$/)?null:"Must be a valid email"}};function l(){return Object.keys(e).forEach(p=>{_(p)}),n.submitted=!0,Object.values(n.errors).every(p=>!p)}function _(p){const f=e[p].validation;if(f&&Object.keys(f).length){let S="";Object.keys(f).find(h=>{const a=f[h];if(a)return S=s[h](n.state[p],a),S}),n.errors[p]=S}}return{form:n}}const Je={class:"flex justify-content-center mt-5"},Qe={class:"surface-card p-4 shadow-2 border-round w-full lg:w-6"},Xe=i("div",{class:"text-center mb-5"},[i("div",{class:"text-900 text-3xl font-medium mb-3"},"Admin Panel")],-1),Ye={__name:"Login",setup(e){const t=R(),{form:o}=G(De,Ee);async function m(){try{await B.post("api/login",{email:o.state.email,password:o.state.password}),await V.push({name:"dashboard"})}catch(s){t.add({severity:"error",summary:"Error",detail:s.response.data.message,life:5e3})}}function n(){o.submit()&&m()}return(s,l)=>{const _=u("Button");return r(),c("div",Je,[i("div",Qe,[Xe,i("div",null,[d(z,{form:b(o),layout:b(Fe)},null,8,["form","layout"]),d(_,{label:"Sign In",icon:"pi pi-user",class:"w-full mt-4",onClick:n})])])])}}},k=j({permissions:[]});async function Ze(){return B.get("api/user").then(e=>{k.value=e.data.data})}async function Ne(e){return B.post("api/access_log",{url:e})}const et={class:"flex align-items-center justify-content-between p-2"},tt={class:"flex"},ot={class:"text-xl"},nt={style:{color:"#555"},class:"ml-2"},st={class:"flex align-items-center gap-4"},at=i("i",{class:"pi pi-sign-in text-xl"},null,-1),rt={},it=Object.assign(rt,{__name:"AppTopBar",setup(e){async function t(){try{await B.get("api/logout"),k.value.permissions=[],await V.push({name:"login"})}catch{}}return(o,m)=>{const n=u("Button");return r(),c("div",et,[i("div",tt,[i("div",ot,[d(b(de),{icon:"pi pi-user",class:"m-1",style:{"background-color":"#dee2e6",color:"#ffffff"},shape:"circle"}),i("span",nt,w(b(k).name),1)])]),i("div",st,[d(n,{rounded:"",text:"",class:"p-2",onClick:t},{default:C(()=>[at]),_:1})])])}}}),lt={class:"layout-wrapper"},ct={class:"flex"},ut={class:"p-2 flex gap-2 flex-column"},dt={class:"flex-grow-1 p-2"},mt={__name:"AdminPanel",setup(e){const t=[{path:"/posts",permission:"posts.view",label:"Posts",icon:"pi-comments"},{path:"/categories",permission:"categories.view",label:"Categories",icon:"pi-tags"},{path:"/users",permission:"users.view",label:"Users",icon:"pi-users"},{path:"/roles",permission:"roles.view",label:"Roles",icon:"pi-cog"}];return(o,m)=>{const n=u("router-link"),s=u("router-view");return r(),c("div",lt,[d(it),i("div",ct,[i("div",ut,[(r(),c(y,null,F(t,l=>(r(),c(y,null,[b(k).permissions.includes(l.permission)?(r(),O(n,{key:0,to:l.path},{default:C(()=>[d(b(te),{plain:"",text:"",rounded:"",class:"block p-2",title:l.label},{default:C(()=>[i("i",{class:L(`pi ${l.icon} text-xl`)},null,2)]),_:2},1032,["title"])]),_:2},1032,["to"])):T("",!0)],64))),64))]),i("div",dt,[d(s)])])])}}},pt={class:"flex justify-content-between mb-3"},_t=i("div",{class:"text-5xl"},"Users",-1),ft={__name:"Users",setup(e){const o={entity:"users",columns:{id:{label:"ID"},name:{label:"Name"},email:{label:"Email"},created_at:{label:"Created at"}}};return(m,n)=>{const s=u("Button"),l=u("router-link"),_=u("CrudTable");return r(),c(y,null,[i("div",pt,[_t,b(k).permissions.includes("users.create")?(r(),O(l,{key:0,to:{name:"users.create"}},{default:C(()=>[d(s,{label:"Create",severity:"secondary",outlined:"",class:"mr-5"})]),_:1},8,["to"])):T("",!0)]),d(_,{config:o})],64)}}},gt={class:"flex justify-content-between mb-3"},bt=i("div",{class:"text-5xl"},"Categories",-1),ht={__name:"Categories",setup(e){const o={entity:"categories",columns:{id:{label:"ID"},name:{label:"Name",search:!0}}};return(m,n)=>{const s=u("Button"),l=u("router-link"),_=u("CrudTable");return r(),c(y,null,[i("div",gt,[bt,b(k).permissions.includes("categories.create")?(r(),O(l,{key:0,to:{name:"categories.create"}},{default:C(()=>[d(s,{label:"Create",severity:"secondary",outlined:"",class:"mr-5"})]),_:1},8,["to"])):T("",!0)]),d(_,{config:o})],64)}}},yt={class:"flex justify-content-between mb-3"},vt=i("div",{class:"text-5xl"},"Posts",-1),xt={__name:"Posts",setup(e){const o={entity:"posts",columns:{id:{label:"ID"},content:{label:"Content",search:!0},category:{label:"Category"},user:{label:"User"},created_at:{label:"Created at"}}};return(m,n)=>{const s=u("Button"),l=u("router-link"),_=u("CrudTable");return r(),c(y,null,[i("div",yt,[vt,b(k).permissions.includes("posts.create")?(r(),O(l,{key:0,to:{name:"posts.create"}},{default:C(()=>[d(s,{label:"Create",severity:"secondary",outlined:"",class:"mr-5"})]),_:1},8,["to"])):T("",!0)]),d(_,{config:o})],64)}}},$t={class:"flex justify-content-between mb-3"},wt=i("div",{class:"text-5xl"},"Roles",-1),Ct={__name:"Roles",setup(e){const o={entity:"roles",columns:{id:{label:"ID"},name:{label:"Name"},user:{label:"Created by"}}};return(m,n)=>{const s=u("Button"),l=u("router-link"),_=u("CrudTable");return r(),c(y,null,[i("div",$t,[wt,b(k).permissions.includes("roles.create")?(r(),O(l,{key:0,to:{name:"roles.create"}},{default:C(()=>[d(s,{label:"Create",severity:"secondary",outlined:"",class:"mr-5"})]),_:1},8,["to"])):T("",!0)]),d(_,{config:o})],64)}}};function kt(e,t){const o=R();function m(){B.post("api/"+e,t.state).then(()=>{V.push({name:e})}).catch(s=>{o.add({severity:"error",summary:"Error",detail:s.response.data.message,life:5e3})})}function n(){t.submit()&&m()}return{submit:n}}const Tt=[["content"],["category_id"]],St={content:{component:"textarea",label:"Content",validation:{required:!0,max:2e3}},category_id:{component:"select",label:"Category",dictionary:"categories",validation:{required:!0}}},Pt={name:""},X=Object.freeze(Object.defineProperty({__proto__:null,config:St,initialState:Pt,layout:Tt},Symbol.toStringTag,{value:"Module"})),Bt=[["name"]],Ot={name:{component:"text",label:"Name",validation:{required:!0,max:128}}},jt={name:""},Y=Object.freeze(Object.defineProperty({__proto__:null,config:Ot,initialState:jt,layout:Bt},Symbol.toStringTag,{value:"Module"})),Vt=[["name"],["email"],["role_id"],["password"]],It={name:{component:"text",label:"Name",validation:{required:!0,max:128}},email:{component:"text",label:"Email",validation:{required:!0,pattern:"email",max:128}},role_id:{component:"select",label:"Role",dictionary:"roles",validation:{required:!0}},password:{component:"text",label:"Password",validation:{required:!0,max:64,min:6}}},Ut={name:"",email:"",password:""},Ft=Object.freeze(Object.defineProperty({__proto__:null,config:It,initialState:Ut,layout:Vt},Symbol.toStringTag,{value:"Module"})),Dt=[["name"],["email"],["role_id"],["password"]],Et={name:{component:"text",label:"Name",validation:{required:!0,max:128}},email:{component:"text",label:"Email",disabled:!0},role_id:{component:"select",label:"Role",dictionary:"roles",validation:{required:!0}},password:{component:"text",label:"Password",validation:{max:64,min:6}}},qt={name:"",email:"",password:""},Lt=Object.freeze(Object.defineProperty({__proto__:null,config:Et,initialState:qt,layout:Dt},Symbol.toStringTag,{value:"Module"})),Rt=[["name"],["permissions"]],At={name:{component:"text",label:"Name",validation:{required:!0,max:128}},permissions:{component:"checkbox-group",label:"Permissions",dictionary:"permissions",validation:{required:!0,max:128}}},zt={name:""},Z=Object.freeze(Object.defineProperty({__proto__:null,config:At,initialState:zt,layout:Rt},Symbol.toStringTag,{value:"Module"})),Mt={"posts.create":{module:X},"posts.edit":{module:X},"categories.create":{module:Y},"categories.edit":{module:Y},"users.create":{module:Ft},"users.edit":{module:Lt},"roles.create":{module:Z},"roles.edit":{module:Z}};function Ht(e){return e.endsWith("ies")?e.slice(0,-3)+"y":e.endsWith("s")?e.slice(0,-1):e}function ne(e){const t=Mt[e].module,o=e.split(".")[0];return t?{layout:t.layout,config:t.config,initialState:t.initialState,url:o,entityName:Ht(o)}:null}const Kt={class:"surface-card p-4 shadow-2 border-round w-5 lg:w-6"},Wt={class:"text-3xl mb-3"},E={__name:"Create",setup(e){const t=oe(),o=W(()=>t.name),{layout:m,config:n,initialState:s,url:l,entityName:_}=ne(o.value),{form:p}=G(n,s),{submit:f}=kt(l,p);return(S,h)=>{const a=u("Button");return r(),c("div",Kt,[i("div",Wt,"Create "+w(b(_)),1),d(z,{form:b(p),layout:b(m)},null,8,["form","layout"]),d(a,{class:"m-2",severity:"success",label:"Submit",onClick:b(f)},null,8,["onClick"])])}}};function Gt(e,t,o){const m=R();function n(){B.put("api/"+e+"/"+t,o.state).then(()=>{V.push({name:e})}).catch(l=>{m.add({severity:"error",summary:"Error",detail:l.response.data.message,life:5e3})})}function s(){o.submit()&&n()}return{submit:s}}const Jt={class:"surface-card p-4 shadow-2 border-round w-5 lg:w-6"},Qt={class:"text-3xl mb-3"},q={__name:"Edit",setup(e){const t=oe(),o=W(()=>t.name),m=R(),{layout:n,config:s,initialState:l,url:_,entityName:p}=ne(o.value),{form:f}=G(s,l),{submit:S}=Gt(_,t.params.id,f);return B.get(`api/${_}/${t.params.id}/edit`).then(h=>{f.state=h.data.data}).catch(h=>{m.add({severity:"error",summary:"Error",detail:h.response.data.message,life:5e3})}),(h,a)=>{const v=u("Button");return r(),c("div",Jt,[i("div",Qt,"Update "+w(b(p)),1),d(z,{form:b(f),layout:b(n)},null,8,["form","layout"]),d(v,{class:"m-2",severity:"success",label:"Submit",onClick:b(S)},null,8,["onClick"])])}}},Xt={},Yt={class:"text-5xl"};function Zt(e,t){return r(),c("div",Yt,"Forbidden")}const Nt=A(Xt,[["render",Zt]]),eo={},to={class:"text-5xl"};function oo(e,t){return r(),c("div",to,"Welcome to dashboard!")}const no=A(eo,[["render",oo]]),so=i("div",{class:"flex justify-content-between mb-3"},[i("div",{class:"text-5xl"},"Access Log")],-1),ao={__name:"AccessLog",setup(e){const o={entity:"access_log",columns:{id:{label:"ID"},url:{label:"Url"},ip:{label:"Ip"},referer:{label:"Referer"},user_agent:{label:"User agent"},created_at:{label:"Created at"}}};return(m,n)=>{const s=u("CrudTable");return r(),c(y,null,[so,d(s,{config:o})],64)}}},ro=[{path:"/login",name:"login",component:Ye},{path:"/",redirect:{name:"dashboard"},component:mt,children:[{path:"/access_log",name:"access_log",component:ao,meta:{permission:"authorized"}},{path:"/forbidden",name:"forbidden",component:Nt,meta:{permission:"authorized"}},{path:"/dashboard",name:"dashboard",component:no,meta:{permission:"authorized"}},{path:"/users",name:"users",component:ft,meta:{permission:"users.view"}},{path:"/users/create",name:"users.create",component:E,meta:{permission:"users.create"}},{path:"/users/:id/edit",name:"users.edit",component:q,meta:{permission:"users.edit"}},{path:"/posts",name:"posts",component:xt,meta:{permission:"posts.view"}},{path:"/posts/create",name:"posts.create",component:E,meta:{permission:"posts.create"}},{path:"/posts/:id/edit",name:"posts.edit",component:q,meta:{permission:"posts.edit"}},{path:"/categories",name:"categories",component:ht,meta:{permission:"categories.view"}},{path:"/categories/create",name:"categories.create",component:E,meta:{permission:"categories.create"}},{path:"/categories/:id/edit",name:"categories.edit",component:q,meta:{permission:"categories.edit"}},{path:"/roles",name:"roles",component:Ct,meta:{permission:"roles.view"}},{path:"/roles/create",name:"roles.create",component:E,meta:{permission:"roles.create"}},{path:"/roles/:id/edit",name:"roles.edit",component:q,meta:{permission:"roles.edit"}}]}],V=me({history:pe(),routes:ro}),N=function(e,t,o){k.value.permissions.includes(e.meta.permission)?(setTimeout(()=>{Ne(e.fullPath)},100),o()):o({name:"forbidden"})};V.beforeEach(async(e,t,o)=>{if(e.meta.permission)if(k.value.permissions.length)N(e,t,o);else return Ze().then(()=>{N(e,t,o)}).catch(()=>{o({name:"login"})});else o()});const io={class:"footer"},lo={style:{"text-align":"right"}},co={key:1,class:"text-3xl flex justify-content-center"},uo={__name:"CrudTable",props:["config"],setup(e){const t=e,o=_e(),m=j(!1),n=j(0),s=j(""),l=j(0),_=j({});Object.keys(t.config.columns).forEach(g=>{t.config.columns[g].search&&(m.value=!0,_.value[g]={value:null,matchMode:fe.STARTS_WITH})});const p=W(()=>Object.keys(_.value).some(g=>_.value[g].value));function f(g){o.require({message:"Are you sure you want to delete?",header:"Confirmation",icon:"pi pi-exclamation-triangle",accept:()=>{B.delete(`api/${t.config.entity}/${g.id}`).then(()=>{a(0)})}})}function S(g){V.push({name:t.config.entity+".edit",params:{id:g.id}})}const h=j({});ge(async()=>{await a()});async function a(g=0,P=1){n.value=g;const H=new Date,K=await B.post("api/query",{entity:t.config.entity,filters:_.value,sort:{field:s.value,order:P},page:g+1});l.value=new Date-H;const I=K.data;h.value=I.data}function v(g){n.value=g.page,a(g.page)}function M(g){a()}function se(g){s.value=g}function ae(g){a(0,g)}return(g,P)=>{const H=u("ConfirmDialog"),K=u("InputText"),I=u("Column"),J=u("Button"),re=u("DataTable"),ie=u("Paginator");return r(),c(y,null,[d(H),p.value||h.value.data&&h.value.data.length?(r(),c(y,{key:0},[d(re,{value:h.value.data,lazy:"",tableStyle:"min-width: 50rem",filterDisplay:m.value?"row":"",onFilter:P[0]||(P[0]=$=>M()),"onUpdate:sortField":P[1]||(P[1]=$=>se($)),"onUpdate:sortOrder":P[2]||(P[2]=$=>ae($)),filters:_.value,"onUpdate:filters":P[3]||(P[3]=$=>_.value=$)},{loading:C(()=>[Q(" Loading customers data. Please wait. ")]),default:C(()=>[(r(!0),c(y,null,F(e.config.columns,($,U)=>(r(),c(y,null,[$.search?(r(),O(I,{key:0,field:U,header:$.label,sortable:$.sortable,"show-filter-menu":!1},{body:C(({data:D})=>[Q(w(g.$filters.truncate(D[U],100)),1)]),filter:C(({filterModel:D,filterCallback:le})=>[d(K,{modelValue:D.value,"onUpdate:modelValue":ce=>D.value=ce,type:"text",onKeydown:be(le,["enter"]),class:"p-column-filter",placeholder:"Search"},null,8,["modelValue","onUpdate:modelValue","onKeydown"])]),_:2},1032,["field","header","sortable"])):(r(),O(I,{key:1,field:U,header:$.label,sortable:$.sortable},null,8,["field","header","sortable"]))],64))),256)),d(I,{header:"Actions"},{body:C($=>[b(k).permissions.includes(e.config.entity+".edit")?(r(),O(J,{key:0,onClick:U=>S($.data),severity:"secondary",outlined:"",size:"small",icon:"pi pi-pencil",class:"smallButton"},null,8,["onClick"])):T("",!0),b(k).permissions.includes(e.config.entity+".delete")?(r(),O(J,{key:1,onClick:U=>f($.data),severity:"secondary",outlined:"",size:"small",icon:"pi pi-trash",class:"ml-2 smallButton"},null,8,["onClick"])):T("",!0)]),_:1})]),_:1},8,["value","filterDisplay","filters"]),i("div",io,[i("div",null,"Query took: "+w(l.value)+" ms",1),d(ie,{rows:h.value.per_page,first:n.value*h.value.per_page,totalRecords:h.value.total,template:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport",rowsPerPageOptions:[20,50,100],onPage:v},null,8,["rows","first","totalRecords"]),i("div",lo," Total: "+w(h.value.total),1)])],64)):(r(),c("div",co,"No data"))],64)}}},mo=A(uo,[["__scopeId","data-v-dc49976f"]]),x=he(Ie);x.component("Button",te);x.component("InputText",ye);x.component("Textarea",ve);x.component("Column",xe);x.component("DataTable",$e);x.component("Paginator",we);x.component("CrudTable",mo);x.component("FormBuilderGrid",z);x.component("Dropdown",Ce);x.component("Toast",ke);x.component("ConfirmDialog",Te);x.component("Checkbox",Se);x.use(V);x.use(Pe);x.use(Be);x.use(Oe);x.mount("#app");x.config.globalProperties.$filters={truncate(e,t,o){return e.slice(0,t)+(t<e.length?o||"...":"")}};
